#!/usr/bin/env bash

# Function: curl_metrics
# Description: Sends metrics data to a specified endpoint using curl
#
# Parameters:
#   $1 - endpoint: The specific endpoint to send the metrics to (e.g., 'job', 'pipeline', 'target')
#   $2 - body: The JSON payload containing the metrics data
#
# Environment Variables:
#   see metrics.mk
#
# Usage:
#   curl_metrics "endpoint" "json_body"
#
function push_metrics() {
    local endpoint="$1"
    local body="$2"
    curl -s ${METRICS_DEBUG:+$METRICS_CURL_DEBUG_OPTS} -X POST "${endpoint}" \
        -H "Content-Type: application/json" \
        ${METRICS_CURL_OPTIONS} \
        -d "${body}" \
        ${METRICS_DEBUG:+2>&1 || :}
}